

 

let Suhail_Md = "Suhail MD Whatsapp bot md"

const Config = require("../config");
let {
  fancytext,
  sendGImages,
  lang,
  tiny,
  runtime,
  formatp,
  botpic,
  prefix,
  sck1,
  smd
} = require("../lib");
const axios = require("axios");
const fetch = require("node-fetch");
const {
  fetchJson,
  getBuffer
} = require("../lib/");

async function sendAnime(bot, message, category, extra = '') {
  try {
    if (category === "waifu" || category === "neko" || category === "megumin") {
      let type = extra.split('|')[0] || '';
      let count = extra.split('|')[1] || '1';
      let caption = extra.split('|')[1] ? '' : ` *${category}, Here we goðŸ˜Š!!!!*`;
      let apiUrl = type === "nsfw" ? `https://api.waifu.pics/nsfw/${category === 'megumin' ? "trap" : "waifu"}` : `https://api.waifu.pics/sfw/${category}`;
      
      for (let i = 0; i < count; i++) {
        let response = await (await fetch(apiUrl)).json();
        await bot.sendMessage(message.chat, {
          'image': {
            'url': response.url
          },
          'caption': caption
        }, {
          'quoted': message
        });
      }
    } else if (category === "loli" || category === "foxgirl") {
      let apiUrl = category === "loli" ? "https://waifu.pics/api/sfw/shinobu" : "https://nekos.life/api/v2/img/fox_girl";
      let response = await axios.get(apiUrl);
      await bot.sendMessage(message.chat, {
        'image': {
          'url': response.data.url
        }
      }, {
        'quoted': message
      });
    } else if (category === "demon" || category === "naruto") {
      let apiUrl = `https://raw.githubusercontent.com/SuhailTechInfo/Suhail-Md-Media/main/${category === "demon" ? 'Demonslayer' : "Naruto"}/video.json`;
      const videoList = await fetchJson(apiUrl);
      const videoUrl = videoList.result[Math.floor(Math.random() * videoList.result.length)].url;
      await bot.sendMessage(message.chat, {
        'video': {
          'url': videoUrl
        },
        'caption': "*silva wave Here we goðŸ˜Š!!!!*"
      });
    } else if (category === "animenews") {
      let newsResponse = await axios.get(`https://newsapi.org/v2/everything?q=${extra}&domains=techcrunch.com,animenewsnetwork.com,myanimelist.net,comingsoon.net,crunchyroll.com&language=en&sortby=publishedat&apikey=cd4116be09ef4a0caceedf21b6258460&pageSize=8`);
      let articles = newsResponse.data.articles;
      
      articles.map(async (article) => {
        try {
          bot.sendMessage(message.chat, {
            'image': {
              'url': article.urlToImage
            },
            'caption': `*TitleðŸ”°:* ${article.title}\n\n*ContentðŸ§©:* ${article.content}\n*AuthorðŸ“Œ:* ${article.author}\n*Sourceâ™¦ï¸:* ${article.source.name}\n*Published Onâ˜˜ï¸:* ${article.publishedAt}\n*More Infoâœ¨:* ${article.url}\n\n${Config.caption}*`
          }, {
            'quoted': message
          });
        } catch (error) {}
      });
    }
  } catch (error) {
    console.log("./commands/Anime.js/sendAnime()\n", error);
    await message.error(error);
  }
}

smd({ 'pattern': "waifu", 'desc': "Get a random Waifu image", 'category': "Anime Images", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, 'waifu'); });
smd({ 'pattern': "neko", 'category': "Anime Images", 'desc': "Sends a Neko image", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, "neko"); });
smd({ 'pattern': "megumin", 'desc': "Get a random Megumin image", 'category': "Anime Images", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, "megumin"); });
smd({ 'pattern': "loli", 'category': "Anime Images", 'desc': "Sends an image of Loli", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, "loli"); });
smd({ 'pattern': "foxgirl", 'category': "Anime Images", 'desc': "Sends an image of Fox Girl", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, "foxgirl"); });
smd({ 'pattern': "demon", 'desc': "Get a random Demon Slayer video", 'category': "Anime Videos", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, "demon"); });
smd({ 'pattern': "naruto", 'desc': "Get a random Naruto video", 'category': "Anime Videos", 'filename': __filename }, async (bot, message) => { return await sendAnime(bot, message, "naruto"); });
smd({ 'pattern': "animenews", 'category': "Anime News", 'desc': "Sends latest Anime news", 'filename': __filename }, async (bot, message, { cmdName }) => { return await sendAnime(bot, message, cmdName, "Anime News"); });
